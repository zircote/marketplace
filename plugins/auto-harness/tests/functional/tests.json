{
  "version": "1.0",
  "description": "auto-harness Plugin Functional Test Suite",
  "generated_by": "auto-harness",
  "tests": [
    {
      "id": "smoke_runner_executable",
      "description": "Verify runner.sh is executable and responds to help",
      "category": "smoke",
      "action": "Run: ./tests/functional/runner.sh --help\nReport the available commands listed.\n",
      "expect": [
        {
          "contains": "init"
        },
        {
          "contains": "next"
        },
        {
          "contains": "validate"
        }
      ],
      "tags": ["smoke", "critical"]
    },
    {
      "id": "smoke_state_directory",
      "description": "Verify .claude directory exists for state storage",
      "category": "smoke",
      "action": "Run: ls -la .claude/\nReport if the directory exists and is accessible.\n",
      "expect": [
        {
          "regex": "(test-state|hooks|total)"
        },
        {
          "not_contains": "No such file"
        }
      ],
      "tags": ["smoke", "state"]
    },
    {
      "id": "runner_state_file_exists",
      "description": "Test that test-state.json exists after init",
      "category": "runner",
      "action": "Run: cat .claude/test-state.json | head -5\nReport if state file exists with valid JSON structure.\n",
      "expect": [
        {
          "contains": "mode"
        },
        {
          "regex": "(running|total_tests)"
        }
      ],
      "tags": ["runner", "init", "critical"]
    },
    {
      "id": "runner_status_shows_progress",
      "description": "Test that runner status shows current test progress",
      "category": "runner",
      "action": "Run: ./tests/functional/runner.sh status\nReport the current test position and counts.\n",
      "expect": [
        {
          "regex": "(Test|tests|progress)"
        },
        {
          "regex": "[0-9]+"
        }
      ],
      "tags": ["runner", "status"]
    },
    {
      "id": "runner_next_returns_test",
      "description": "Test that runner next returns test details",
      "category": "runner",
      "action": "Run: ./tests/functional/runner.sh next\nReport the test ID and action returned.\n",
      "expect": [
        {
          "contains": "Test"
        },
        {
          "regex": "(Action|action|description)"
        }
      ],
      "tags": ["runner", "next"]
    },
    {
      "id": "template_runner_valid",
      "description": "Verify runner.sh template contains required functions",
      "category": "templates",
      "action": "Run: grep -c \"cmd_init\\|cmd_next\\|cmd_validate\\|cmd_status\" templates/runner/runner.sh\nReport the count of required functions found.\n",
      "expect": [
        {
          "regex": "[4-9]|[1-9][0-9]"
        },
        {
          "not_contains": "0"
        }
      ],
      "tags": ["templates", "runner"]
    },
    {
      "id": "template_hooks_valid",
      "description": "Verify hooks.json template has UserPromptSubmit hook",
      "category": "templates",
      "action": "Run: cat templates/hooks/hooks.json\nReport if UserPromptSubmit hook is configured.\n",
      "expect": [
        {
          "contains": "UserPromptSubmit"
        },
        {
          "contains": "test-wrapper.sh"
        }
      ],
      "tags": ["templates", "hooks"]
    },
    {
      "id": "template_tests_yaml_valid",
      "description": "Verify tests.yaml template has correct structure",
      "category": "templates",
      "action": "Run: head -30 templates/tests/tests.yaml\nReport if it contains version and tests array.\n",
      "expect": [
        {
          "contains": "version"
        },
        {
          "contains": "tests"
        }
      ],
      "tags": ["templates", "tests"]
    },
    {
      "id": "structure_plugin_manifest",
      "description": "Verify plugin.json manifest is valid JSON with required fields",
      "category": "structure",
      "action": "Run: python3 -c \"import json; d=json.load(open('.claude-plugin/plugin.json')); print(f'name={d[\\\"name\\\"]} version={d[\\\"version\\\"]}')\"\nReport the plugin name and version.\n",
      "expect": [
        {
          "contains": "auto-harness"
        },
        {
          "regex": "version=[0-9]"
        }
      ],
      "tags": ["structure", "manifest", "critical"]
    },
    {
      "id": "structure_commands_directory",
      "description": "Verify commands directory has required command files",
      "category": "structure",
      "action": "Run: ls -1 .claude/commands/\nReport the command files found.\n",
      "expect": [
        {
          "regex": "(init|validate|run-tests)"
        }
      ],
      "tags": ["structure", "commands"]
    },
    {
      "id": "structure_skills_directory",
      "description": "Verify skills directory exists with skill files",
      "category": "structure",
      "action": "Run: ls -1 .claude-plugin/skills/ 2>/dev/null || echo \"no skills directory\"\nReport what skill files exist.\n",
      "expect": [
        {
          "regex": "(skill|.md|no skills)"
        }
      ],
      "tags": ["structure", "skills"]
    },
    {
      "id": "structure_agents_directory",
      "description": "Verify agents directory exists with agent files",
      "category": "structure",
      "action": "Run: ls -1 .claude-plugin/agents/ 2>/dev/null || echo \"no agents directory\"\nReport what agent files exist.\n",
      "expect": [
        {
          "regex": "(agent|.md|no agents)"
        }
      ],
      "tags": ["structure", "agents"]
    },
    {
      "id": "meta_state_json_valid",
      "description": "Test that test-state.json is valid JSON after operations",
      "category": "meta",
      "action": "Run: python3 -c \"import json; d=json.load(open('.claude/test-state.json')); print(f'current_index={d.get(\\\"current_index\\\", \\\"N/A\\\")} total={len(d.get(\\\"filtered_tests\\\", []))}')\"\nReport the state structure.\n",
      "expect": [
        {
          "contains": "current_index"
        },
        {
          "regex": "total=[0-9]+"
        }
      ],
      "tags": ["meta", "state"]
    },
    {
      "id": "meta_validate_pass",
      "description": "Test that validate correctly identifies passing response (self-validates)",
      "category": "meta",
      "action": "Run: ./tests/functional/runner.sh validate \"This test passed successfully with init and next and validate\"\nReport the validation result.\n",
      "expect": [
        {
          "regex": "(PASS|pass|success)"
        }
      ],
      "tags": ["meta", "validate"]
    },
    {
      "id": "meta_report_generation",
      "description": "Test that report command generates valid markdown",
      "category": "meta",
      "action": "Run: ./tests/functional/runner.sh report | head -20\nReport if markdown report was generated with summary table.\n",
      "expect": [
        {
          "contains": "Test Execution Report"
        },
        {
          "regex": "(Passed|Failed|Summary)"
        }
      ],
      "tags": ["meta", "report"]
    }
  ]
}
